namespace = SLMod_events_nobility_disaster_namespace

# Nobles
country_event = {
	id = SLMod_events_nobility_disaster_namespace.1
	title = SLMod_events_nobility_disaster_namespace.1.title
	desc = SLMod_events_nobility_disaster_namespace.1.desc
	picture = CORRUPTION_eventPicture
	hidden = no

	trigger = {
		has_disaster = estate_nobility_disaster
	}
	
	mean_time_to_happen = {
		days = 365
	}
	
	# Manpower loss ==> Reduce disaster
	option = {
		name = SLMod_events_nobility_disaster_namespace.1.a
		custom_tooltip = SLMod_events_nobility_disaster_namespace.1.a.tooltip
		trigger = {
			manpower_percentage = 0.9
		}
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -2
		}
		add_disaster_progress = {
			disaster = estate_nobility_disaster
			value = -2
		}
		add_yearly_manpower = -1
	}
	
	# Prestige loss ==> Reduce disaster
	option = {
		name = SLMod_events_nobility_disaster_namespace.1.b
		custom_tooltip = SLMod_events_nobility_disaster_namespace.1.b.tooltip
		trigger = {
			prestige = 80
		}
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -2
		}
		add_disaster_progress = {
			disaster = estate_nobility_disaster
			value = -2
		}
		add_prestige = -5
	}
	
	# Ducats loss ==> Reduce disaster
	option = {
		name = SLMod_events_nobility_disaster_namespace.1.c
		custom_tooltip = SLMod_events_nobility_disaster_namespace.1.c.tooltip
		trigger = {
			years_of_income = 1
		}
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -2
		}
		add_disaster_progress = {
			disaster = estate_nobility_disaster
			value = -2
		}
		add_years_of_income = -1
	}
	
	# Turn against other estates ==> Reduce disaster
	option = {
		name = SLMod_events_nobility_disaster_namespace.1.d
		custom_tooltip = SLMod_events_nobility_disaster_namespace.1.d.tooltip
		
		trigger = {
			NOT = {
				has_disaster = estate_church_disaster
				has_disaster = estate_burghers_disaster
			}
		}
		
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -2
		}
		add_disaster_progress = {
			disaster = estate_nobility_disaster
			value = -2
		}
		add_estate_influence_modifier = {
			estate = estate_church
			desc = increased_estate_influence
			influence = 5
			duration = 365
		}
		add_estate_influence_modifier = {
			estate = estate_burghers
			desc = increased_estate_influence
			influence = 5
			duration = 365
		}
	}
	
	# Default ==> Advance disaster
	option = {
		name = SLMod_events_nobility_disaster_namespace.1.z
		custom_tooltip = SLMod_events_nobility_disaster_namespace.1.z.tooltip

		add_disaster_progress = {
			disaster = estate_nobility_disaster
			value = 5
		}
		if = {
			limit = {
				is_at_war = yes
			}
			add_war_exhaustion = 2
		}
		if = {
			limit = {
				NOT = { # If progress has not reach 50%
					has_disaster_progress = {
						disaster = estate_nobility_disaster
						value = 50
					}
				}
			}
			add_disaster_progress = {
				disaster = estate_nobility_disaster
				value = 5
			}
		}
	}
}